<!doctype html>

<html lang='en'>
  <head>
    <meta charset='utf-8'/>
    <title>yt++</title>
    <script>
      // get remote and ipcRenderer (interprocess communication)
      const {remote, ipcRenderer} = require('electron');
      // get internal api
      const api = remote.require('./api.js');

      // setup jquery
      window.$ = window.jQuery = require('jquery');

      // apply event handlers on document ready
      $(document).ready(() => {
        $('#download').mousedown(() => {
          try {
            api.download($('#query').val(), $('#filepath').val(), $('#format').val());
          }
          catch (e) {
            $('#status').html('Error: ' + e);
          }
        });
      });

      // set progress bar and status message
      function setStatus(message, progress) {
        // set status variable
        $('#status').html(message);
        // TODO update progress bar
      }

      // allow main process to set the remote status
      ipcRenderer.on('set-status', (event, args) => {
        setStatus(args.message, args.progress);
      });
    </script>
  </head>
  <body>
    <div id='searchbar'>
      <input id='query' type='text'/>
      <button id='search'>Search</button>
      <div id='search-results'>

      </div>
    </div>
    <div class='formbox'>
      <button id='download'>Download As</button>
      <select id='format'>
        <optgroup label='Video'>
          <option>mp4</option>
          <option>flv</option>
          <option>avi</option>
          <option>3gp</option>
          <option>webm</option>
          <option>mov</option>
        </optgroup>
        <optgroup label='Audio'>
          <option>mp3</option>
          <option>m4a</option>
          <option>wav</option>
          <option>ogg</option>
        </optgroup>
      </select>
      <input id='filepath' type='text'/>
      <button id='selectfile'>Select</button>
    </div>
    <div class='formbox'>
      <button id='stream'>Stream Audio</button>
      <button id='setpause'>Pause</button>
      <button id='stopstream'>Stop</button>
      <label for='#volume'>Volume</label>
      <input id='volume' type='range' min='0' max='100' value='50'/>
      <label for='#device'>Device</label>
      <select id='device'>
        <!-- populate at run time-->
        <script>
          let deviceList = Object.keys(api.getDevices());
          let optionsHtml = '';
          for(var x of deviceList) {
            optionsHtml += `<option>${x}</option>`;
          }
          $('#device').html(optionsHtml);
        </script>
      </select>
    </div>
    <div id='status-box'>
      <span id='status'></span>
      <div id='progress-bar'>

      </div>
    </div>
  </body>
</html>
